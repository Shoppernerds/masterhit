<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MasterHit | Cartas PokÃ©mon en Chile</title>
<meta name="description" content="MasterHit: tienda de cartas PokÃ©mon TCG. EnvÃ­os a todo Santiago." />
<meta property="og:title" content="MasterHit | Cartas PokÃ©mon en Chile">
<meta property="og:description" content="Cajas selladas, ETB, boosters y singles. EnvÃ­os a todo Chile.">
<meta property="og:type" content="website">
<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 256 256'%3E%3Ccircle cx='128' cy='128' r='120' fill='%23e60000'/%3E%3Ccircle cx='128' cy='128' r='88' fill='%23fff'/%3E%3Ccircle cx='128' cy='128' r='40' fill='%23000'/%3E%3C/svg%3E">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#0b0b0c;--card:#111215;--muted:#9aa2ae;--line:#20242b;--fg:#f5f7fb;
  --accent:#e60000;--accent-2:#fff;--radius:16px;--shadow:0 10px 30px rgba(0,0,0,.45)
}
*{box-sizing:border-box}
html,body{margin:0;height:100%;background:var(--bg);color:var(--fg);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
a{color:inherit;text-decoration:none}
img{max-width:100%;display:block}
.container{max-width:1200px;margin:0 auto;padding:20px}
body.is-locked{overflow:hidden;touch-action:none}
.nav{position:sticky;top:0;z-index:50;background:#000;border-bottom:2px solid var(--accent)}
.nav-inner{display:flex;gap:12px;align-items:center;justify-content:space-between;padding:14px 20px}
.brand{display:flex;gap:10px;align-items:center;font-weight:800;color:var(--accent-2)}
.brand-badge{position:relative;width:28px;height:28px;border-radius:999px;background:linear-gradient(#e60000 0 50%, #fff 50% 100%);box-shadow:0 0 0 3px #000,0 0 0 6px #fff;overflow:hidden}
.brand-badge:before{content:"";position:absolute;left:0;right:0;top:50%;height:3px;background:#000;transform:translateY(-50%)}
.brand-badge:after{content:"";position:absolute;inset:0;margin:auto;width:10px;height:10px;border-radius:50%;background:#000;box-shadow:0 0 0 3px #fff,0 0 0 5px #000}
.btn{cursor:pointer;border-radius:12px;border:1px solid var(--line);background:var(--card);color:var(--fg);padding:10px 14px;display:inline-flex;align-items:center;gap:8px}
.btn.primary{background:var(--accent);border-color:var(--accent);color:#fff}
.cart-count{display:inline-flex;min-width:22px;height:22px;border-radius:999px;align-items:center;justify-content:center;background:#fff;color:#000;font-weight:800;font-size:.85rem;padding:0 6px}
.hero{padding:36px 20px;text-align:center;background:#111}
.hero h1{font-size:1.6rem;color:#fff;margin:0}
.controls{display:flex;flex-direction:column;gap:10px;padding:0 20px}
.counter{color:var(--fg);font-weight:800;font-size:1.1rem;padding:10px 14px;border-left:3px solid var(--accent);border-radius:8px;background:#0f1116}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:14px;padding:20px}
.product{background:var(--card);border:1px solid var(--line);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden;display:flex;flex-direction:column;position:relative}
.product img{height:200px;object-fit:contain;background:#fff}
.pad{padding:12px;flex:1;display:flex;flex-direction:column;gap:8px}
.price-wrap{display:flex;align-items:baseline;gap:10px;flex-wrap:wrap}
.price-new{font-weight:900;font-size:1.05rem;color:#fff}
.price-old{color:var(--muted);text-decoration:line-through}

/* Drawer (carrito) */
.drawer{position:fixed;right:0;top:0;height:100%;width:440px;max-width:100%;background:#111;color:#fff;border-left:2px solid var(--accent);transform:translateX(100%);transition:.3s;z-index:100;display:flex;flex-direction:column;overscroll-behavior:contain}
.drawer.open{transform:translateX(0)}
.drawer header{padding:12px;border-bottom:1px solid var(--line);display:flex;justify-content:space-between;align-items:center}
#cartBody{flex:1;overflow:auto;padding:12px}
.cart-item{display:grid;grid-template-columns:92px 1fr auto;gap:12px;align-items:center;border:1px solid var(--line);background:#0f1116;border-radius:12px;padding:10px;margin-bottom:10px}
.cart-item img{width:92px;height:92px;object-fit:contain;background:#fff;border-radius:10px}
.cart-title{font-weight:700;font-size:1rem;line-height:1.2}
.cart-meta{font-size:.95rem;color:#cfd4dd;margin-top:4px}
.qty{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--line);border-radius:999px;padding:8px 10px;font-weight:700}
.qty button{all:unset;cursor:pointer;font-size:1.1rem;line-height:1}
.cart-price{font-weight:800;font-size:1rem;text-align:right}
.drawer-footer{padding:12px;border-top:1px solid var(--line)}
.drawer-footer .total{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;font-weight:800;font-size:1.05rem}

/* Modal checkout */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;place-items:center;z-index:90;overscroll-behavior:contain}
.modal.open{display:grid}
.checkout-card{width:min(820px,95vw);background:#111;border:1px solid var(--line);border-radius:16px;box-shadow:var(--shadow);overflow:hidden}
.checkout-card header{padding:12px 14px;border-bottom:1px solid var(--line);display:flex;justify-content:space-between;align-items:center}
.checkout-body{padding:16px;display:grid;gap:16px}
.section{border:1px solid var(--line);border-radius:12px;padding:12px}
.section h3{margin:0 0 10px 0}
.input{width:100%;max-width:100%;border-radius:10px;border:1px solid var(--line);background:#0f1116;color:#fff;padding:10px;margin-bottom:8px}
.radio-row{display:grid;gap:8px}
.code{font-family:ui-monospace,monospace;background:#0f1116;border:1px dashed var(--line);padding:10px;border-radius:8px;white-space:pre-wrap}
.actions{display:flex;gap:10px;justify-content:flex-end}
.badge-fee{display:inline-block;background:#1a1d24;border:1px solid #2a2f39;color:#fff;padding:2px 8px;border-radius:999px;font-size:.85rem;margin-left:6px}
@media (max-width:640px){
  .grid{grid-template-columns:repeat(2,minmax(0,1fr));gap:10px}
  .product img{height:150px}
  .drawer{width:100%}
}
</style>
</head>
<body>
<nav class="nav">
  <div class="nav-inner container">
    <a href="#" class="brand"><span class="brand-badge"></span> MASTERHIT</a>
    <button id="btnCart" class="btn primary">ðŸ›’ Carrito <span class="cart-count" id="cCount">0</span></button>
  </div>
</nav>

<section class="hero">
  <h1>Compra sellados, sobres o singles de PokÃ©mon TCG al mejor precio y con entrega rÃ¡pida en Huechuraba, Lampa, Colina y Quilicura.</h1>
</section>

<div class="controls container"><span id="counter" class="counter">Sellados Disponibles:</span></div>
<section class="container"><div id="grid" class="grid"></div></section>

<!-- Drawer Carrito -->
<aside id="drawer" class="drawer" aria-hidden="true">
  <header><strong>Tu carrito</strong><button id="btnClose" class="btn">âœ•</button></header>
  <div id="cartBody"></div>
  <div class="drawer-footer">
    <div class="total"><span>Subtotal</span><strong id="grand">â€”</strong></div>
    <button id="btnCheckout" class="btn primary" style="width:100%">Pagar con Transferencia</button>
  </div>
</aside>

<!-- Checkout -->
<div id="checkout" class="modal" aria-hidden="true">
  <div class="checkout-card">
    <header><strong>Finalizar compra</strong><button id="coClose" class="btn">âœ•</button></header>
    <div class="checkout-body">
      <div class="section" id="coStep1">
        <h3>1) Tus datos y entrega</h3>
        <input id="coName" class="input" placeholder="Nombre y Apellido">
        <input id="coPhone" class="input" placeholder="+56 9 1234 5678">
        <input id="coEmail" class="input" placeholder="Correo electrÃ³nico">
        <h3>Elige tu entrega</h3>
        <div class="radio-row">
          <label><input type="radio" name="coOpt" value="rm" checked> Despacho RegiÃ³n Metropolitana <span class="badge-fee">+ $5.000</span> â€” Entrega garantizada entre 1 y 3 dÃ­as. Horario 18:00 - 21:00 hrs.</label>
          <label><input type="radio" name="coOpt" value="vg"> Entrega en Valle Grande, Lampa â€” Disponible en 1 dÃ­a. Horario 17:00 - 21:00 hrs.</label>
          <label><input type="radio" name="coOpt" value="ce"> Entrega en Ciudad Empresarial, Huechuraba â€” Disponible en 1 dÃ­a. Horario 12:00 - 15:00 hrs.</label>
        </div>
        <div class="actions" style="margin-top:8px;">
          <button id="coNext" class="btn primary">Confirmo mi pedido</button>
        </div>
      </div>

      <div class="section" id="coStep2" style="display:none">
        <h3>2) Su nÃºmero de pedido es <span id="coOrderHuman">#0167</span></h3>
        <div class="code" id="coSummary" style="margin-bottom:10px"></div>

        <h3>Datos de transferencia</h3>
        <div id="coBank" class="code"></div>

        <div class="actions" style="margin-top:10px">
          <button id="coBack" class="btn">Volver</button>
          <button id="coFinish" class="btn primary">Confirmar compra</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
/* ---------- Config ---------- */
const RM_FEE = 5000;
const BANK = {
  holder:'Jorge Galvez',
  rut:'18.041.726-5',
  bank:'Banco de Chile',
  type:'Cuenta Corriente',
  number:'580520907',
  email:'jorge@shoppernerds.com'
};
const WA_TARGET = '+56975121963';

/* ---------- CatÃ¡logo de ejemplo (puedes reemplazar por tu JSON) ---------- */
const PRODUCTS = [
  {id:'spc-prismatic-en', name:'Prismatic Evolutions', set:'SPC Â· INGLÃ‰S', price:29990, compare:0, img:'https://raw.githubusercontent.com/placeholderimg/paint/main/600x360.png'},
  {id:'special-garchomp-es', name:'Garchomp EX', set:'SPECIAL Â· ESPAÃ‘OL', price:25000, compare:34990, img:'https://raw.githubusercontent.com/placeholderimg/paint/main/600x360.png'},
  {id:'etb-rivales-es', name:'Rivales Predestinados', set:'ETB Â· ESPAÃ‘OL', price:40000, compare:54990, img:'https://raw.githubusercontent.com/placeholderimg/paint/main/600x360.png'},
  {id:'special-charizardex-es', name:'Charizard EX', set:'SPECIAL Â· ESPAÃ‘OL', price:25000, compare:34990, img:'https://raw.githubusercontent.com/placeholderimg/paint/main/600x360.png'}
];

/* ---------- Utilidades ---------- */
const $ = s => document.querySelector(s);
function fmt(n){return new Intl.NumberFormat('es-CL',{style:'currency',currency:'CLP',maximumFractionDigits:0}).format(n||0)}
function lock(b){document.body.classList.toggle('is-locked',b)}
function toast(msg){alert(msg)}

/* ---------- Estado ---------- */
let CART = [];
let orderSeq = 167;

/* ---------- Render catÃ¡logo ---------- */
function renderGrid(){
  const g = $('#grid'); g.innerHTML='';
  PRODUCTS.forEach(p=>{
    const card = document.createElement('article');
    card.className='product';
    card.innerHTML = `
      <img src="${p.img}" alt="${p.name}">
      <div class="pad">
        <div style="font-weight:800">${p.name}</div>
        <div style="color:#cdd3dd">${p.set}</div>
        <div class="price-wrap">
          <span class="price-new">${fmt(p.price)}</span>
          ${p.compare?`<span class="price-old">${fmt(p.compare)}</span>`:''}
        </div>
        <button class="btn primary" data-id="${p.id}">AÃ±adir</button>
      </div>`;
    card.querySelector('button').onclick=()=>addToCart(p.id);
    g.appendChild(card);
  });
  $('#counter').textContent = `Sellados Disponibles: ${PRODUCTS.length}`;
}
function addToCart(id){
  const p = PRODUCTS.find(x=>x.id===id);
  const i = CART.find(x=>x.id===id);
  if(i){ i.qty = Math.min(i.qty+1, 9); }
  else { CART.push({id:p.id,name:p.name,price:p.price,img:p.img,qty:1}); }
  updateCartUI();
  openDrawer();
}

/* ---------- Drawer & Carrito ---------- */
function openDrawer(){ $('#drawer').classList.add('open'); lock(true); }
function closeDrawer(){ $('#drawer').classList.remove('open'); lock(false); }
$('#btnCart').onclick=openDrawer; $('#btnClose').onclick=closeDrawer;

function updateCartUI(){
  $('#cCount').textContent = CART.reduce((s,i)=>s+i.qty,0);
  $('#cartBody').innerHTML = CART.length? '' : `<p style="color:#cdd3dd">Tu carrito estÃ¡ vacÃ­o.</p>`;
  CART.forEach((i,idx)=>{
    const row = document.createElement('div');
    row.className='cart-item';
    row.innerHTML = `
      <img src="${i.img}" alt="${i.name}">
      <div>
        <div class="cart-title">${i.name}</div>
        <div class="cart-meta">c/u ${fmt(i.price)}</div>
        <div class="qty" aria-label="Cantidad">
          <button data-act="dec">âˆ’</button>
          <span>${i.qty}</span>
          <button data-act="inc">+</button>
          <button data-act="del" title="Quitar" style="margin-left:8px">ðŸ—‘</button>
        </div>
      </div>
      <div class="cart-price">${fmt(i.price*i.qty)}</div>`;
    row.querySelector('[data-act="inc"]').onclick=()=>{i.qty=Math.min(i.qty+1,9);updateCartUI();}
    row.querySelector('[data-act="dec"]').onclick=()=>{i.qty=Math.max(i.qty-1,1);updateCartUI();}
    row.querySelector('[data-act="del"]').onclick=()=>{CART.splice(idx,1);updateCartUI();}
    $('#cartBody').appendChild(row);
  });
  const sub = CART.reduce((s,i)=>s+i.price*i.qty,0);
  $('#grand').textContent = fmt(sub);
}

/* ---------- Checkout ---------- */
const modal = $('#checkout');
function openCheckout(){
  if(!CART.length){toast('Carrito vacÃ­o');return}
  modal.classList.add('open'); lock(true);
}
function closeCheckout(){ modal.classList.remove('open'); lock(false); }
$('#btnCheckout').onclick=openCheckout; $('#coClose').onclick=closeCheckout;

$('#coNext').onclick=()=>{
  // Paso 1 -> Paso 2
  if(!$('#coName').value || !$('#coPhone').value || !$('#coEmail').value){
    toast('Completa nombre, WhatsApp y correo.'); return;
  }
  const opt = document.querySelector('input[name="coOpt"]:checked').value;
  const isRM = opt==='rm';
  const idHuman = '#'+String(orderSeq++).padStart(4,'0');
  $('#coOrderHuman').textContent = idHuman;

  const items = CART.map(i=>`â€¢ ${i.name} x${i.qty} â€” ${fmt(i.price)}\n  LÃ­nea = ${fmt(i.price*i.qty)}`).join('\n');
  const subtotal = CART.reduce((s,i)=>s+i.price*i.qty,0);
  const fee = isRM ? RM_FEE : 0;
  const total = subtotal + fee;

  const entregaTxt = (()=>{
    if(opt==='rm') return 'Despacho RegiÃ³n Metropolitana â€” 1 a 3 dÃ­as (18:00â€“21:00)';
    if(opt==='vg') return 'Retiro: Valle Grande, Lampa â€” 1 dÃ­a (17:00â€“21:00)';
    return 'Retiro: Ciudad Empresarial, Huechuraba â€” 1 dÃ­a (12:00â€“15:00)';
  })();

  $('#coSummary').textContent =
`Pedido ${idHuman}
-------------------
${items}

Subtotal: ${fmt(subtotal)}
${isRM?`Cargo despacho: ${fmt(fee)}\n`:''}Total a transferir: ${fmt(total)}

Cliente: ${$('#coName').value}
WhatsApp: ${$('#coPhone').value}
Email: ${$('#coEmail').value}
Entrega: ${entregaTxt}`;

  // Datos bancarios en filas separadas
  $('#coBank').textContent =
`- Titular: ${BANK.holder}
- RUT: ${BANK.rut}
- Banco: ${BANK.bank}
- Tipo: ${BANK.type}
- NÂ° Cuenta: ${BANK.number}
- Email envÃ­o comprobante: ${BANK.email}`;

  // Mostrar paso 2
  $('#coStep1').style.display='none';
  $('#coStep2').style.display='block';
};

$('#coBack').onclick=()=>{
  $('#coStep2').style.display='none';
  $('#coStep1').style.display='block';
};

$('#coFinish').onclick=()=>{
  // Enviar por WhatsApp
  const text = $('#coSummary').textContent + `

Datos de transferencia
${$('#coBank').textContent}

Gracias por tu compra.`;
  const url = `https://wa.me/${WA_TARGET.replace(/[^0-9]/g,'')}?text=${encodeURIComponent(text)}`;
  window.open(url,'_blank');

  // Cerrar y limpiar
  closeCheckout(); closeDrawer();
  CART = []; updateCartUI();
};

/* ---------- Init ---------- */
renderGrid();
updateCartUI();
</script>
</body>
</html>
